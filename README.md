# Telegram Channel Users Parser

Этот скрипт использует библиотеку Telethon для парсинга участников Telegram-канала (2605 участников) с личного аккаунта. Парсинг выполняется с поиском по цифрам (0–9), русским (а–я) и английским (a–z) буквам, исключая дубликаты по ID пользователей. Конфиденциальные данные хранятся в файле `.env`.

## Требования

- Python 3.7+
- Установленные библиотеки:
  ```bash
  pip install telethon python-dotenv
  ```

## Установка

1. **Клонируйте или скачайте проект**:
   - Сохраните скрипт `main.py` и файл `.env` в одну папку.

2. **Получите API-ключи**:
   - Перейдите на [my.telegram.org](https://my.telegram.org).
   - Авторизуйтесь с вашим номером телефона.
   - Создайте приложение и получите `API_ID` и `API_HASH`.

3. **Настройте `.env`**:
   - Создайте файл `.env` в папке со скриптом.
   - Заполните его следующим образом:
     ```plaintext
     API_ID=your_api_id
     API_HASH=your_api_hash
     CHANNEL_ID=-100123456789
     ```
     - `CHANNEL_ID` — ID канала (например, `-100123456789`). Узнайте через бота @GetChannelIDBot.

4. **Проверьте права аккаунта**:
   - Убедитесь, что ваш Telegram-аккаунт имеет доступ к списку участников канала (например, вы администратор или канал публичный).

## Запуск

1. **Запустите скрипт**:
   ```bash
   python main.py
   ```
2. **Авторизация**:
   - При первом запуске введите ваш номер телефона (например, `+522881026523`).
   - Введите код авторизации, отправленный в Telegram.
   - Если включена двухфакторная аутентификация, введите пароль.

3. **Процесс парсинга**:
   - Скрипт выполняет поиск по цифрам (0–9), русским (а–я) и английским (a–z) буквам.
   - Дубликаты исключаются по ID.
   - Результаты сохраняются в `channel_users.csv` в формате:
     ```csv
     ID,Username,First Name,Last Name
     123456789,user123,Иван,Иванов
     ...
     ```
   - Ожидаемое время: ~1-3 минуты для 2605 участников.

## Особенности

- **Лимит API**: Telegram ограничивает запросы до 200 участников. Скрипт обрабатывает это, итерируясь по поисковым запросам.
- **Поиск**: Используются 69 символов (10 цифр + 33 русские буквы + 26 английских).
- **Задержки**: 2 сек между запросами, 10 сек при ошибках (например, flood wait).
- **Дубликаты**: Исключаются по ID пользователя.
- **Остановка**: Скрипт завершается при сборе 2605 уникальных участников.

## Устранение неполадок

- **Flood Wait**:
  - Если появляется ошибка `FloodWaitError`, увеличьте задержку в скрипте:
    ```python
    await asyncio.sleep(5)  # вместо 2
    ```
- **Меньше 2605 участников**:
  - Некоторые аккаунты могут быть скрыты (боты, удаленные).
  - Добавьте в `search_queries` дополнительные символы, например:
    ```python
    search_queries += [' ', '@']
    ```
- **Ошибка доступа**:
  - Проверьте, имеет ли аккаунт права на просмотр участников.
- **Логи**:
  - Скрипт выводит прогресс (например, `Обработано 200 участников для запроса "а", уникальных: 200`).

## Безопасность

- Не публикуйте `.env` в репозиториях. Добавьте в `.gitignore`:
  ```plaintext
  .env
  ```
- Используйте скрипт ответственно, чтобы избежать ограничений Telegram.

## Результат

Файл `channel_users.csv` содержит список участников без дубликатов с полями:
- `ID`: Уникальный ID пользователя.
- `Username`: Имя пользователя (если есть).
- `First Name`: Имя (если указано).
- `Last Name`: Фамилия (если указана).
